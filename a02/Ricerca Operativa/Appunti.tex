\documentclass{article}

\usepackage[italian]{babel}
\usepackage[utf8]{inputenc}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{booktabs}
\usepackage{mathtools}
\usepackage{tabularx}

\usepackage{listings}
\usepackage{pgfplots}
\usepackage{tikz}
\usetikzlibrary{tikzmark}
\usepackage{nicematrix}
\pgfplotsset{compat=1.16}

\usepackage{xcolor}
\usepackage[table]{xcolor}
\usepackage{tcolorbox}
\tcbuselibrary{breakable}

\usepackage{titlesec} 
\usepackage{caption}
\usepackage{subcaption}

\usepackage{geometry}

\title{Ricerca Operativa}
\author{Mascherpa Matteo}
\date{a.a. 2024-2025}

\definecolor{darkgreen}{rgb}{0.0, 0.56, 0.22}
\definecolor{lightgray}{rgb}{0.85, 0.85, 0.85}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=1pt] (char) {#1};}}
\tikzset{terminal/.style={
  % The shape:
  rectangle,minimum size=6mm,rounded corners=3mm,
  % The rest
  very thick,draw=black!50,
  top color=lightgray,bottom color=black!20,
  font=\ttfamily}}

  

\begin{document}

\maketitle
\tableofcontents

\section{Introduzione}
Con lo scalare improvviso delle imprese della rivoluzione industriale è diventata preponderante la necessità di allocare al meglio le risorse disponibili. Spesso se un'operazione cresce velocemente è facile che ogni compartimento diventi un'entità a sé stante rendendo complessa la gestione. Da questa necessità è emersa la \textit{Ricerca operativa} che è maturata ed è stata sfruttata per la prima volta nella seconda guerra mondiale. Servì per allocare nel miglior modo le poche risorse inglesi per evitare di soccombere ai tedeschi. Con l'avvenire dei computer poi questa materia ha avuto una spinta che la ha portata alla situazione attuale.

\subsection{Attributi di una decisione}
Una buona decisione è caratterizzata da:
\begin{enumerate}
  \item \textbf{\textit{Efficace}}: Raggiunge lo scopo prefissato.
  \item \textbf{\textit{Efficente}}: Nel raggiungere lo scopo prefissato lo fa in modo da sprecare meno risorse possibile
  \item \textbf{\textit{Tempestiva}}: Viene attuata in un arco di tempo coerente con l'orizzonte degli eventi prefissato(strategico(immediato), tattico(medio peridio), operativo(a lungo periodo)).
  \item \textbf{\textit{Robusta}}: Rimane la una buona scelta anche in caso in caso di variazioni trascurabili.
  \item \textbf{\textit{Giustificabile}}: Se si ha il compito di spiegare il motivo della decisione si può fare senza dover usare sotterfugi e depistaggi.
\end{enumerate}



\section{Panoramica all'approccio della modellazione}
Nonostante la parte più preponderante della materia sia composta da metodi matematici non si deve dimenticare che una parte dello sforzo è la \textit{raccolta dei dati}.
Un riassunto delle varie fasi di uno studio sono:
\begin{enumerate}
  \item Definire il problema e ottenere i dati.
  \item Formulare il modello matematico che rappresenti il problema.
  \item Sviluppare la procedura per derivare la soluzione del problema dal modello.
  \item Test, miglioramento, rifinatura fino a quando si è soddisfatti.
  \item Preparare l'applicazione operativa della soluzione.
  \item Implementazione della soluzione trovata.
\end{enumerate}

\subsection{Definire il problema}
Solitamente il problema da risolvere è descritto in termini vaghi, va quindi trovato un modo per formalizzarlo. Solitamente, non si deve dare la "soluzione" ma un insieme di diverse alternative dove il cliente sceglierà quella che più lo aggrada in base a quale soluzione lo attrae di più(Alcuni potrebbero volere una estrema rapidità altri una maggiore robustezza). Per prima cosa si deve discernere i \textbf{principi fondamentali}, che saranno quelli che guideranno la scelta finale. Generalmente per le imprese i punti salienti sono: \textit{Proprietario, Imppiegati, Clienti, Fornitori, Governo/nazione}.

\subsection{Formulo il modello matematico}
Il modello matematico sono versioni idealizzate della realtà per una più facile lavorazione. Esso è composto da \textbf{\textit{variabili decisionali}}, $(x_1,\dots,x_n)$ che rappresentano i valori come valori determinati. Le misure delle prestazioni con le \textbf{\textit{funzioni obiettivo}} espresse come funzioni aritmetiche, $(P=3x_1+2x_2+\dots+mx_n)$. Ci sono anche modi per avere delle restrizioni, chiamate \textbf{\textit{vincoli}}, espresse come equazioni, $(3x_1+2x_2+\dots+mx_n<10)$. Le costanti del modello vengono chiamate \textbf{\textit{parametro del modello}}. Solitamente, per motivo di incertezza, i parametri non sono altro che grezze stime, concetto a cui ci si riferisce come \textbf{\textit{sensitività d'analisi}}. Una volta modellato il problema esso non diventa altro che un problema di programmazione lineare. Bisogna evitare però di creare un modello insoddisfaciibile essendo il modello astratto e idealizzato ma con un utilizzo concreto. Un criterio per giudicare un modello è la relativa correttezza in base alle scelte prese. Nello sviluppo del modello è buona pratica da cominciare da un nucleo ristretto e arricchirlo, questo processo si chiama \textbf{\textit{arricchimento del modello}}. In caso gli obiettivi fossero molteplici essi vengono trasformati in una misura composita chiamata: \textbf{\textit{Misura globale delle prestazioni}}.

\subsection{Sviluppare la procedura}
Solitamente un passo semplice dove applicare al modello sviluppato precedentemente un \textit{algoritmo standard}, la parte più complessa è l'\textit{analisi postottimale}. Gli algoritmi infatti restituiscono la soluzione \textit{ottime} per il modello dato, il problema è che il modello dato essendo un astrazione può quasi sempre essere migliorato per ottenere una nuova soluzione migliore. \textbf{\textit{Herbert Simon}}, nobel per l'economia, ha definito "\textit{satisficing}" (\textit{soddisfacente}) la tendenza dei manager a cercare una soluzione "\textit{abbastanza buona}" e non per forza ottima. Bisogna, nella modifica del modello porre attenzione alla \textit{sensitività delle analisi}, cioè determinare quale parametro modifica considerevomente la soluzione e la sposta di più verso un obiettivo che più si confà alla realtà del problema.

\subsection{Test, Miglioramento, e rifinatura}
Essendo i casi della realtà, al contrario degli esempi didattici, enormi è delirante aspettarsi che la prima soluzione trovata sia quella che alla fine si andrà ad attuare. Per questo esiste questa fase dove il modello viene messo sotto stress fino ad arrivare ad un livello soddisfacente. Non ci si può neanche aspettare di arrivare alla versione perfetta, si punta perciò alla minimizzazione dei bachi. Questo processo si chiama \textbf{\textit{validazione del modello}}. Visto l'ammontare di tempo speso nelle fasi precedenti è facile trascurare, per dimenticanza, vari dettagli. Per questo è spesso consigliato che a questo processo venga aggiunto nel team un elemento totalmente avulso dal progetto. Tra gli errori più frequenti ci sono gli errori di incosistenze nelle unità dei valori, \textit{consistenza dimensionale}. Un approccio sistematico è il \textit{test a retrospettiva}. Ciò consiste nell'utilizzo di dati passati per ricostruire vecchi scenari simili e determinare la risposta del modello. Lo svantaggio è che i dati usati per i test sono gli stessi usati per creare il modello quindi non i migliori per trovare le falle.

\subsection{Preparazione dell'applicazione}
Una volta testato il modello ed essere arrivati ad una versione da adottare allora si deve creare una documentazione estesa che spieghi ogni dettaglio del modello. Il sistema che verrà creato sarà quasi certamente informatizzato. In questa fase si creano le \textit{basi di dati} e \textit{sistemi di gestione delle informazioni}. In caso le decisioni da prendere siano interattive si crea un \textit{sistema di supporto alle decisioni} in modo da avere un rapido accesso alle possibili migliori decisioni.

\subsection{Implementazione}
La fase critica in cui le scelte prese in precedenza vanno, finalmente, attuate nel modo più accurato possibile al modello ricavato dai mesi di lavoro. Tasselli importanti nell'applicazione sono la comunicazione tra reparti. se tutto viene svolto in cordinazione tra i vari capi reparto il modello potrà essere utilizzato per anni, per questo è importante un riscontro costante per potere avere aggiustamenti minori che vanno documentati e motivati. Grazie a questo si potrà andare avanti fino a quando non cambieranno le necessità che il modello soddisfaceva.

\section{Programmazione lineare}
In breve l'applicazione più comune per la programmazione lineare è l'allocazione di \textit{risorse limitate}. La \textit{programmazione lineare} usa modelli matematici, dove lineare indica che le funzioni utilizzate devono essere lineari. Un metodo efficente per trovare la soluzione è l'\textbf{\textit{algoritmo del simplesso}}.

\subsection{Prototipo esempio}
\subsubsection{Il problema}

Il problema è così formulato:
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Problema di PL Schiopparelli \& Co,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Schiopparelli \& CO produce vetri di alta qualità e ha $3$ stabilimenti. Lo scopo è massimizzare il guadagno bilanciando la quantità dei vari prodotti.
  \begin{itemize}
    \item \textbf{Stabilimento 1:} Crea gli infissi in alluminio.
    \item \textbf{Stabilimento 2/3:} Creano e assemblano le fenistre.
  \end{itemize}
  I prodotti sono:
  \begin{itemize}
    \item \textbf{Portafinistra:} Alta $2,4m$ con infissi in alluminio.\\  \hspace*{5mm} Necessita \textit{Stabilimento 1 e 3}
    \item \textbf{Doppia finestra:} $1,2m$ x $1,8m$ con infissi in legno.\\  \hspace*{5mm} Necessita \textit{Stabilimento 2 e 3}
  \end{itemize}
  I dati necessari:
  \begin{itemize}
    \item Numero di ore di lavoro disponibili a settimana in ogni stabilimento per ogni prodotto.
    \item Numero di ore necessarie per assemblare ogni prodotto.
    \item Profitto per ogni insieme di prodotti
  \end{itemize}

  \textbf{Modello risultante}: \\ \\
  \begin{tabular}{cccc}
    \toprule
                                & \multicolumn{2}{c}{\textbf{Tempi di produzione per lotto}} &                                                                          \\
    \cmidrule(lr){2-3}
    \textbf{Stabilimento}       & \textbf{Prod. 1}                                           & \textbf{Prod. 2} & \parbox{1.5in}{\textbf{Produzione a settimana ($h$)}} \\
    \midrule
    1                           & 1                                                          & 0                & 4                                                     \\
    2                           & 0                                                          & 2                & 12                                                    \\
    3                           & 3                                                          & 2                & 18                                                    \\
    \midrule
    \textbf{Profitto per lotto} & \$3,000                                                    & \$5,000          &                                                       \\
    \bottomrule
  \end{tabular}
\end{tcolorbox}

\subsubsection{Formulazione per la programmazione lineare}
Il modello allora per il problema.

$$
  \begin{cases}
    x_1 = \text{N° lotti prod. 1 per settimana}                 \\
    x_2 = \text{N° lotti prod. 2 per settimana}                 \\
    Z = \text{Profitto totale per settimana(in migliaia di \$)} \\
  \end{cases}
$$

Quindi $x_1$,$x_2$ sono \textit{variabili decisionali} del modello. Dalla tabella precedente si ottiene $Z = 3x_1+tx_2$. L'obiettivo è trovare i valori $x_1$,$x_2$ tale che $Z$ abbia il valore massimo. Introduciamo ora i vincoli degli orari dei vari stabilimenti. Lo stabilimento 1: $x_1\le4$, stabilimento 2: $2x_2\le12$, stabilimento 3: $3x_1+2x_2\le18$, e infine i \textit{limiti di positività}. Si arriva quindi al sistema:

$$ \text{Modello}=
  \begin{cases}
    x_1 \le 4          \\
    2x_2 \le 12        \\
    3x_1 + 2x_2 \le 18 \\
    x_1 \ge 0          \\
    x_2 \ge 0          \\
    Z = 3x_1 + 5x_2
  \end{cases}
$$

\subsection{Soluzione dei grafici}
Avendo questo problema due \textit{variabili decisionali} su può usare un grafico bidimensionale. Analazziamo la soluzione passo passo. In \textit{blu} ci sono i vincoli di positività $x_1\ge0$, $x_2\ge0$. In \textit{rosso} il inseriamo i vincoli $x_1\le4$ e $2x_2\le12$ e $3x_1+2x_2\le18$. In \textit{verde} l'area delle possibili soluzioni. Si arriva quindi al punto di scegliere un punto che massimizzi $Z=3x_1+5x_2$. Da qui si avanza con il metodo \textit{trial and error} prendendo un valore arbitrario.


\begin{figure}[ht]
  \centering
  \begin{subfigure}[b]{0.45\textwidth}
    \begin{tikzpicture}
      \begin{axis}[
          xlabel={$x_1$},
          ylabel={$x_2$},
          grid=major,
          axis lines=left,
          xmin=0, xmax=5,
          ymin=0, ymax=10,
          title={Soluzione grafica}
        ]

        %Primo punto
        \draw[blue] (axis cs:0,0) -- (axis cs:0,10);
        \addplot[blue, domain=0:10, samples=100] {0};
        %Secondo punto
        \draw[red] (axis cs:4,0) -- (axis cs:4,10) node[pos=0.8, above, rotate=90] {\textcolor{blue}{$x_1\le4$}};
        \addplot[red, domain=0:10, samples=10] {6} node[pos=0.1, above] {\textcolor{blue}{$2x_2\le18$}};
        \addplot[red, domain=0:10, samples=10] {-3/2*x+9} node[pos=0.4, above, rotate=-33]{\textcolor{blue}{$3x_1+2x_2\le18$}};

        %Terzo punto

        \coordinate (A) at (axis cs:0,0);
        \coordinate (B) at (axis cs:0,6);
        \coordinate (C) at (axis cs:2,6);
        \coordinate (D) at (axis cs:4,3);
        \coordinate (E) at (axis cs:4,0);

        \fill[green, opacity=0.5] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;
        \draw[green, thick] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;
      \end{axis}
    \end{tikzpicture}
    \caption{Soluzione grafica}
  \end{subfigure}
  \quad
  \begin{subfigure}[b]{0.45\textwidth}
    \begin{tikzpicture}
      \begin{axis}[
          xlabel={$x_1$},
          ylabel={$x_2$},
          grid=major,
          axis lines=left,
          xmin=0, xmax=6,
          ymin=0, ymax=10,
          title={Possibili soluzioni}
        ]
        \addplot[red, domain=0:10, samples=10] {-3/5*x+36/5} node[pos=0.2, above, rotate=-15]{\textcolor{blue}{$Z=36=3x_1+5x_2$}};
        \addplot[red, domain=0:10, samples=10] {-3/5*x+20/5} node[pos=0.2, above, rotate=-15]{\textcolor{blue}{$Z=20=3x_1+5x_2$}};
        \addplot[red, domain=0:10, samples=10] {-3/5*x+10/5} node[pos=0.2, above, rotate=-15]{\textcolor{blue}{$Z=10=3x_1+5x_2$}};



        \coordinate (A) at (axis cs:0,0);
        \coordinate (B) at (axis cs:0,6);
        \coordinate (C) at (axis cs:2,6);
        \coordinate (D) at (axis cs:4,3);
        \coordinate (E) at (axis cs:4,0);

        \fill[green, opacity=0.1] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;
        \draw[green, thick] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;

      \end{axis}
    \end{tikzpicture}
    \caption{Possibili soluzioni}
  \end{subfigure}

\end{figure}

Si noti nel grafico a sinistra che tutte le rette sono parallele, infatti sono tutte forme di una funzione chiamata \textbf{slope-intercept form}, in questo caso è $x_2=-\frac{3}{5}x_1+\frac{1}{5}Z$. Nel grafico a destra si può vedere che la soluzione massima sia $(x_1=2,x_2=6)$ portando $Z=36$.

\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=ATTENZIONE,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Nell'esempio fornito si può utilizzare un piano per la scaristà di parametri, ma con il crescere del numero di parametri cresce il numero di dimensioni del grafico. In caso la \textit{regione ammissibile} diventa un poliedro che può essere: \textit{vuoto} in caso non esistano soluzioni ammissibili, \textit{illimitato} in caso in almeno una dimensione non esiste il \textit{valore ottimo}. Esiste poi un almeno un vertice di tale poliedro che corrisponde ad un \textit{valore ottimo}. In ogni caso il poliedro è convesso.

\end{tcolorbox}

\subsection{Modello di programmazione lineare}
Abbiamo visto come trovare la soluzione graficamente, ora vediamo l'approccio di programmazione lineare. Cominciamo ora con termini necessari e notazione. \textit{Risorse} e \textit{attività}, dove $m$ indica il numero di risorse utilizzabili e $n$ il numero di attività considerate. Lo scopo in questo caso è trovare i \textit{livelli} delle attività per avere la \textit{migliore prestazione globale}. Di seguito la lista di simboli e il grafico generici per la programmazione lineare.
\begin{itemize}
  \item $Z$: Valore totale delle prestazioni.
  \item $x_j$: Livello dell'attività $j\in[1,n]$.
  \item $c_j$: Incremento in $Z$ per ogni incremento unitario dell'attività $j$.
  \item $b_i$: Ammontare delle risorse $i$ disponibili per l'attività. $i\in[1,m]$.
  \item $a_{ij}$: Valore della risorsa $i$ consumata da ogni unità di attività $j$.
\end{itemize}

\begin{table}[ht]
  \centering
  \begin{tabular}{|c|c|c|c|c|c|}
    \hline
    \multicolumn{6}{|c|}{\textbf{Risorse usate per Unità di attività}}                                                                                        \\
    \hline
    \textbf{Risorse}       & \multicolumn{4}{|c|}{\textbf{Attività}} & \textbf{Quantità di risorse disponibili}                                               \\
    \cline{2-5}
                           & \textbf{1}                              & \textbf{2}                               & \textbf{$\cdots$} & \textbf{$n$} &          \\
    \hline
    1                      & $a_{11}$                                & $a_{12}$                                 & $\cdots$          & $a_{1n}$     & $b_1$    \\
    2                      & $a_{21}$                                & $a_{22}$                                 & $\cdots$          & $a_{2n}$     & $b_2$    \\
    $\vdots$               & $\vdots$                                & $\vdots$                                 & $\ddots$          & $\vdots$     & $\vdots$ \\
    $m$                    & $a_{m1}$                                & $a_{m2}$                                 & $\cdots$          & $a_{mn}$     & $b_m$    \\
    \hline
    \multicolumn{6}{|c|}{\textbf{Contributo a $Z$ per unità}}                                                                                                 \\
    \hline
    \multicolumn{1}{|c|}{} & $c_1$                                   & $c_2$                                    & $\cdots$          & $c_n$        &          \\
    \hline
  \end{tabular}
\end{table}

\subsection{Forma standard del modello}
Dalla tabella precedente si deriva il modello generale(\textbf{forma standard}) dal quale si può derivare il modello per il problema che abbia già risolto graficamente.\\

\subsubsection{Modello generale}
$$
  \begin{cases}
    \begin{rcases}
      Z = c_1x_1 + \dots + c_nx_n \hspace{1.75cm}
    \end{rcases} \text{Funzione obiettivo, da massimizzare} \\
    \begin{rcases}
      a_{11}x_1 + a_{12}+\dots + a_{1n}x_n \le b_1 \\
      a_{21}x_1 + a_{22}+\dots + a_{2n}x_n \le b_2 \\
      \vdots                                       \\
      a_{m1}x_1 + a_{m2}+\dots + a_{mn}x_n \le b_m \\
    \end{rcases} \text{Vincoli funzionali}            \\
    \begin{rcases}
      x_1\ge0 \\
      \vdots  \\
      x_n \ge 0 \hspace{4.10cm}
    \end{rcases} \text{Vincoli di non negatività}
  \end{cases}
$$

\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Versioni alternative,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  \begin{itemize}
    \item Minimizzare la \textit{funzione obiettivo}.
    \item Rivoltare i \textit{vincoli funzionali} in modo da avere $\ge$.
    \item Porre un \textit{vincolo funzionale} a un ugualianza.
    \item Eliminare \textit{vincoli di non negatività}.
  \end{itemize}
\end{tcolorbox}

\subsubsection{Soluzione del modello}


  \begin{tikzpicture}
    \begin{axis}[
        xlabel={$x_1$},
        ylabel={$x_2$},
        grid=major,
        axis lines=left,
        xmin=0, xmax=6,
        ymin=0, ymax=10,
        title={Possibili soluzioni}
      ]
      \coordinate (A) at (axis cs:0,0);
      \coordinate (B) at (axis cs:0,6);
      \coordinate (C) at (axis cs:2,6);
      \coordinate (D) at (axis cs:4,3);
      \coordinate (E) at (axis cs:4,0);

      \fill[gray, opacity=0.5] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;
      \draw[black, thick] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;
      \draw[opacity=0](1,1) -- (3,3) node[pos=0.5, above, opacity=1]{Regione accettabile};
    \end{axis}
  \end{tikzpicture}

\subsection{Soluzione aritmetica del modello}
Metodo per risolvere il modello evitando di utilizzare il grafico. Si parte quindi dal \textit{modello lineare} per portarlo in forma standard e poi risolverlo. Per portare il modello in forma standard tutti i vincoli di \textit{disuguaglianza} devono essere trasformati in \textit{vincoli di ugualianza} e la funzione obiettivo $Z$ vengono poste in forma di minizzazione. \\ Per poter portare ogni vincolo di \textit{disuguaglianza} ad un vincolo di \textit{ugualianza} si aggiunge una variabile di \textit{slack} per ogni vincolo in gorma di disuguaglianza.

$$
  \begin{cases}
    Z = x_1 + 3x_2 - 3x_3     \\
    -3x_1 + 2x_2 - 2x_3 \le 9 \\
    -4x_1 - 3x_2 + 3x_3 \le 8 \\
    x_1 \ge 0,
    x_2 \ge 0,
    x_3 \ge 0
  \end{cases}
  \to
  \begin{cases}
    Z = x_1 + 3x_2 - 3x_3                         \\
    -3x_1 + 2x_2 - 2x_3 \textcolor{red}{+x_4 =} 9 \\
    -4x_1 - 3x_2 + 3x_3 \textcolor{red}{+x_5 =} 8 \\
    x_1 \ge 0,
    x_2 \ge 0,
    x_3 \ge 0                                     \\
    \textcolor{red}{x_4 \ge 0, x_5 \ge 0}
  \end{cases}
$$

Si passa così da un sistema da $m$ vincoli e $n$ variabili ad un modello con $m$ vincoli e $n+m$ variabili. Si rimane quindi con una matrice che, a meno di vincoli ridondanti, ha \textbf{Rango $m$}. Il sistema ha una soluzione univoca se eliminando gli $n$ gradi di libertà usando $n$ variabili.

\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Teorema di Rouché Capelli,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Data una matrice in forma $A'=[A|b]$ dove $A$ è una matrice $m\ x\ n$ e $b$ un vettore di $n$ elementi allora:
  \begin{enumerate}
    \item Se il sistema è risolubile la soluzione è unica se, e solo se, $r(A')=k$ dove $k$ è il numero di incognite del sistema.
    \item Se il sistema è risolubile si hanno $\infty^j$ soluzioni($j$ gradi di infinito) se, e solo se, $j=k-r(A')$.
  \end{enumerate}
\end{tcolorbox}

La soluzione poi si trova estrapolando la base($B$) dal modello dove il resto del modello lo chiamiamo $N$. Il modello allora lo si può riscrivere in forma $[B|N]$. Riscrivo quindi il modello nella forma $B_{x_B}+N_{x_N}=b$ dove $x_B$ e $x_N$ sono le soluzioni del sistema. La soluzione si ottiene dopo aver posto a $0$ tutte le $n$ variabili che non appartengono a $B$. Per farlo si inverte la matrice $B$, quindi si ottiene: $x_B=B^{-1}b-B^{-1}N_{X_N}$ da qui si comprende il motivo di porre $X_N$ a $0$ visto che la soluzione è:$X_N=0, X_B = B^{-1}b$.

\subsubsection{Degenerazione del modello}
La degenerazione si ottiene quando si pone a $0$ un parametro interno alla base $B$. Questo porta ad avere più soluzioni basiche decidibili.

\subsubsection{\textbf{Teorema fondamentale della PL}}
Dato il problema lineare in forma standard
$$Z=\text{min}\{c^Tx:Ax=b, \ge 0 \}$$
con $A|r(A)=m$
\begin{enumerate}
  \item Se esiste una \textit{soluzione ammissibile} esiste anche una soluzione di base
  \item Se esiste una \textit{soluzione ottima} esiste una soluzione ottima di base.
\end{enumerate}

\subsection{Assunzioni sulla programmazione lineare}

\subsubsection{Proporzionalità}
Il contributo di ogni attività al \textit{valore della funzione obiettivo $Z$} è proporzionale al livello dell'attività $x_j$ rappresentata da $c_jx_j$ in $Z$. Come il contributo nei vincoli funzionali è proporzionale al livello di $x_j$ rappresentato da prodotto $a_{ij}x_j$. L'assunzione dice dunque esclude ogni esponente diverso da quello neutro$(1)$ per ogni variabile nel modello lineare.

\subsubsection{Addività}
Ogni funzione nel modello lineare è la somma dei contributi individuali delle rispettive attività.

\subsubsection{Divisibilità}
Le variabili di decisione in un modello di programmazione lineare possono avere un qualsiasi valore, (anche non interi) per soddisfare i vincoli. Quindi i valori non sono obbligatoriamente interi, quindi un attività può essere svolta a \textit{livelli frazionati}.

\subsubsection{Certezza}
Il valore assegnato ad ogni parametro si assume sia una costante conosciuta.

\section{Risolvere i problemi di PL con l'algoritmo del simplesso:}
Arrivati a questo punti si deve introdurre l'\textit{algoritmo del simplesso} una procedura generale per risolvere problemi di programmazione lineare sviluppato da \textit{George Dantzig} nel 1947.

\subsection{Il concetto}
Il metodo del simplesso è un metodo algebrico che si basa su un concetto geometrico. Quindi una prefazione geometrica aiuta a comprendere il concetto sotto. Per evitare di definire un nuovo esempio riprenderemo quello del capitolo precendente di "Schiopparelli \& CO".

\begin{figure}[ht]
  \centering
  \begin{subfigure}[b]{0.45\textwidth}
    $$ \text{Modello}=
      \begin{cases}
        x_1 \le 4          \\
        2x_2 \le 12        \\
        3x_1 + 2x_2 \le 18 \\
        x_1 \ge 0          \\
        x_2 \ge 0          \\
        Z = 3x_1 + 5x_2
      \end{cases}
    $$ \\ \\ \\ \\ \\
    \caption{Modello del problema "Schiopparelli \& CO"}
  \end{subfigure}
  \quad
  \begin{subfigure}[b]{0.45\textwidth}
    \begin{tikzpicture}
      \begin{axis}[
          xlabel={$x_1$},
          ylabel={$x_2$},
          grid=major,
          axis lines=left,
          xmin=0, xmax=6,
          ymin=0, ymax=10,
          title={Possibili soluzioni}
        ]

        \draw[red] (axis cs:4,0) -- (axis cs:4,10);
        \addplot[red, domain=0:10, samples=10] {6};
        \addplot[red, domain=0:10, samples=10] {-3/2*x+9};

        \coordinate (A) at (axis cs:0,0);
        \coordinate (B) at (axis cs:0,6);
        \coordinate (C) at (axis cs:2,6);
        \coordinate (D) at (axis cs:4,3);
        \coordinate (E) at (axis cs:4,0);

        \fill[gray, opacity=0.5] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;
        \draw[black, thick] (A) -- (B) -- (C) -- (D) -- (E) -- cycle;
        \draw[opacity=0](1,1) -- (3,3) node[pos=0.5, above, opacity=1]{Regione accettabile};

        \fill (0,0) circle (2pt) node[above right] {\color{darkgreen}{$(0,0)$}};
        \fill (0,6) circle (2pt) node[above right] {\color{darkgreen}{$(0,6)$}};
        \fill (2,6) circle (2pt) node[above right] {\color{darkgreen}{$(2,6)$}};
        \fill (4,3) circle (2pt) node[above right] {\color{darkgreen}{$(4,3)$}};
        \fill (4,0) circle (2pt) node[above right] {\color{darkgreen}{$(4,0)$}};
        \fill (0,9) circle (2pt) node[above right] {\color{red}{$(0,9)$}};
        \fill (4,6) circle (2pt) node[above right] {\color{red}{$(4,6)$}};
        \fill (6,0) circle (2pt) node[above left ] {\color{red}{$(6,0)$}};
      \end{axis}


    \end{tikzpicture}
    \caption{Soluzioni grafiche}
  \end{subfigure}

\end{figure}

Si noti come i punti evidenziati(CFP) non siano altro che l'intersezione di due \textit{vincoli}, alcuni sono al limitare e altri no, rispettivamente quelli \textit{verdi} e quelli \textit{rossi}, se ora questa affermazione lascia il tempo che trova più tardi sarà importante.

\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Definizione del simplesso,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Per ogni problema lineare con $n$ variabili di decisione due CPF sono \textit{adiacenti} se condividono $n-1$ vincoli. Due CPF adiacenti sono uniti da un segmento sulle dimensioni dei vincoli condivisi. Ci si riferisce a questo segmento come: \textbf{Spigolo} della regione accettabile.
\end{tcolorbox}

Per la soluzione si usa il \textbf{test di ottimalità}:

\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Test di ottimalità,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Considerando un qualsiasi problema di programmazione lineare che possiede almeno una soluzione ottimale. Se una soluzione CPF non ha \textit{adiacenze} migliori allora quella soluzione è la soluzione migliore.
\end{tcolorbox}


\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Test di illimitatezza,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Si dice illimitato un problema se non esistono candidati pivot su una colonna con costo ridotto negativo.
\end{tcolorbox}

\subsubsection{L'algoritmo}
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Algoritmo del simplesso,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  while ($\lnot$ inaccettabile(b,c))$\land$ ($\lnot$ Baseaccettabile(b)) do\\
  Pivot(A,b,c)\\
  if(inaccettabile(b,c)) then\\
  Stop: Problema inammissibile\\
  else\\
  while($\lnot$ Ottimale(c))$\land$ ($\lnot$ Illimitato(A,c)) do\\
  Pivot(A,b,c)\\
  if(Ottimale(c)) then\\
  Stop: Soluzione ottima\\
  else\\
  Stop: Problema illimitato\\
\end{tcolorbox}

\subsection{Variabili artificiali:}
Dato un modello di programmazione lineare in forma standard con $n$ variabili e $m$ vincoli nella forma: $Z=$min$\{C^Tx:Ax=b\}$. Si può introdurre una variabile artificiale $u_i\ge0\ \forall i \in [1,m]$. Così si ottiene il problema artificiale $Z^a=$min\{$e^Tu:Ax+Iu=b$\} con $e^T=[1,\dots,1]$. Si può dimostrare che il problema $Z^a\cong Z$ ma la differenza fondamentale è che trovare una base iniziale in $Z^a$ è estremamente semplice e da lì si può risolvere il modello tramite l'algoritmo del simplesso. Infatti con la sostituzione $u_i=b_i-\sum_{j=1}^{n}a_{ij}x_j$ si ottiene una riga del \textit{tablue} con una riga tutta uguale a zero. Si arriva quindi a una soluzione iniziale dove $x=0$ e $u=b$ ma ammissibile. Si è trovata una soluzione ottimale se si trova $Z^a=0$ altrimenti $Z$ è inammissibile.
\subsubsection{Evitare $m$ passi per rendere non basiche $m$ variabili}
Per evitare gli $m$ passi si possono usare dele variabili di slack.
$$
  \begin{cases}
    \text{Min} (Z=\sum_{j=1}^{n}c_jx_j)              \\
    \sum_{j=1}^{n}a_{ij}x_j\ge b_i \forall i \in I_1 \\
    \sum_{j=1}^{n}a_{ij}x_j\le b_i \forall i \in I_2 \\
    \sum_{j=1}^{n}a_{ij}x_j = b_i \forall i \in I_3  \\
    x\ge 0
  \end{cases}
  \to
  \begin{cases}
    \text{Min} (Z=\sum_{j=1}^{n}c_jx_j)                                         \\
    \sum_{j=1}^{n}a_{ij}x_j+\textcolor{red}{\hat{x_i}}\ge b_i \forall i \in I_1 \\
    \sum_{j=1}^{n}a_{ij}x_j-\textcolor{red}{\hat{x_i}}\le b_i \forall i \in I_2 \\
    \sum_{j=1}^{n}a_{ij}x_j = b_i \forall i \in I_3                             \\
    x, \hat{x} \ge 0
  \end{cases}
$$
Le variabili $\hat{x_i}$ per $i \in I_1$ soddisfano la prima condizione della forma canonica. Invece sia $h\in I_2|h=\text{max}_{i\in I_2} {b_i}$ sottraendo ogni riga nella forma $\le$ si ottengono i vincoli equivalenti con termine noto non-negativo e variabile $\hat{x_i}$. Si necessita quindi di inserire variabili artificiali soòo per il vincolo $h$ e per i vincoli in $I_3$.

\subsubsection{Metodo "\textit{Big M}"}
Al posti di eliminare dal problema il problema delle varibiali aritificiali $x$ è possibile le variabili $u$ e penalizzarle. Si risolve il problema $Z^a=\text{min}(c^Tx+w^Tu:Ax+Iu=b)|w^T=[M,\dots,M]$ sia un vettore di coefficenti abbastanza grandi in modo che ogni soluzione con $u_i$ sia penalizzata a tal punto da rendere favorevoli solo le soluzioni influenzate da $c^T$ cioè quelle che appartengono anche a $Z$ originale.

\subsubsection{Balinsky-Gomery}
Quest'algoritmo trascura temporaneamente la funzione obiettivo e minimizza l'inammissibilità del vincolo violato finché si trova una base ammissibile o si scopre che il problema è inammissibile.

\subsection{Risolvere il problema d'esempio:}
\begin{minipage}{0.55\textwidth}
  Dato che nel nostro problema $n=2$ i CPF adiacenti devono condividere un vincolo.
\end{minipage}
\hfill
\begin{minipage}{0.30\textwidth}
  \begin{tabular}{|c|c|}
    \hline
    \textbf{CPF} & \textbf{Adiacenze} \\
    \hline
    $(0,0)$      & $(0,6),(4,0)$      \\
    $(0,6)$      & $(2,6),(0,0)$      \\
    $(2,6)$      & $(4,3),(0,6)$      \\
    $(4,3)$      & $(4,0),(2,6)$      \\
    $(4,0)$      & $(0,0),(4,3)$      \\
    \hline
  \end{tabular}
\end{minipage}

\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Esempio di algoritmo del simplesso,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  \textbf{Inizializzazione}: \\
  Prendo $(0,0)$ come soluzione CPF da esaminare, non c'è un vero e proprio criterio per scegliere in questo caso era solo il più semplice. \\
  \circled{1}\textbf{Test di ottimalità}: \\
  \textcolor{red}{Fallito}, non è ottimale, esiste una soluzione migliore adiacente. \\
  \textbf{Iterazione 1:}
  Mi muovo verso $(0,6)$ usando i seguenti step.
  \begin{enumerate}
    \item Considero(nella tabella) i due CPF adiacenti $(0,6)$ e $(4,0)$, da cui vien fuori: $(0,6): Z=3\cdot 0 + 6 \cdot 5 = 30$ e $(4,0): Z=3 \cdot 4 + 5 \cdot 0 = 12$. Ora prendo il valore che massimizza $Z$, quindi $(0,6)$ mi muoverò nella direzione di $x_2$ fino a trovare il primo CPF.
    \item Mi fermo all'incontrare primo vincolo incontrato: $2x_2 \le 12$ per evitare di uscire dalla \textit{regione accettabile}.
    \item Risolvo l'intersezione del nuovo insieme di vincoli.
  \end{enumerate}

  \circled{2}\textbf{Test di ottimalità}: \\
  \textcolor{red}{Fallito}, non è ottimale, esiste una soluzione migliore adiacente. \\

  \textbf{Iterazione 2:}
  Mi muovo verso $(2,6)$ usando i seguenti step.
  \begin{enumerate}
    \item Considero(nella tabella) i due CPF adiacenti $(2,6)$ e $(0,0)$, da cui vien fuori: $(0,0): Z=3\cdot 0 + 6 \cdot 0 = 0$ e $(2,6): Z=3 \cdot 2 + 5 \cdot 6 = 36$. Ora prendo il valore che massimizza $Z$, quindi $(2,6)$ mi muoverò nella direzione di $x_1$ fino a trovare il primo CPF.
    \item Mi fermo all'incontrare primo vincolo incontrato: $3x_1+2x_2\le18$ per evitare di uscire dalla \textit{regione accettabile}.
    \item Risolvo l'intersezione del nuovo insieme di vincoli.
  \end{enumerate}

  \circled{3}\textbf{Test di ottimalità}: \\
  \textcolor{darkgreen}{Passato}, è ottimale, non esiste una soluzione migliore adiacente. Ho trovato la soluzione migliore.\\

\end{tcolorbox}
\subsubsection{Concetti della soluzione:}
\begin{enumerate}
  \item Il simplesso si concentra esclusivamnete sui CPF perché se esite una soluzione migliore ne esiste una che coincide con un CPF.
  \item Il simplesso è algoritmo \textit{iterativo}.
        \usetikzlibrary {calc,positioning,shapes.misc}
        \begin{tikzpicture}[node distance=5mm and 5mm,
            skip loop/.style={to path={-- ++(0,-.5) -| (\tikztotarget)}}]
          \node (init)[terminal]{Inizializzazione};
          \node (test)[terminal, right=of init]{Test di ottimalità};
          \node (pass)[terminal, above right=of test]{\textcolor{darkgreen}{Passato}};
          \node (fail)[terminal, below right=of test]{\textcolor{red}{Fallito}};
          \node (iter)[terminal, right=of fail]{Iterazione};
          \node (end)[terminal, right=of pass]{Soluzione ottima};

          \path (init) edge[->] (test)
          (test) edge[->] (pass)
          (test) edge[->] (fail)
          (fail) edge[->] (iter)
          ($ (iter.east) + (2mm,0) $)
          edge[->,skip loop] ($ (test.west) - (2mm,0) $)
          (pass) edge[->] (end)
          ;

          \draw (iter.east) -- ($(iter.east) + (2mm,0)$);

        \end{tikzpicture}
  \item Se possibile per l'inizializzazione si sceglie l'origine in modo da eliminare entropia iniziale.
  \item Computazionalmente è più efficente confrontare il CPF adiacenti.
  \item Dopo aver trovato un CPF controlla se ne esiste uno adiacente migliore, cerca per ogni paramatro quale deve essere modificato per incrementare di più la funzione obiettivo. O per meglio dire quale incrementa di più il \textit{rateo di incremento di $Z$}

\end{enumerate}
\subsection{Il metodo del simplesso}
Per quanto graficamente sia più facile da comprendere queseto metodo non si può tradurre computazionalmente, per poterlo rendere computabile lo si deve formalizzare aritmeticamente. Come nel capitolo precedente per la soluzione aritmetica si pone il modello in forma aumentata.

$$
  \begin{cases}
    Z = 3x_1 + 5x_2 \\
    x_1 \le 4       \\
    2x_2 \le 12     \\
    3x_1+2x_2\le 18 \\
    x_1 \ge 0,
    x_2 \ge 0
  \end{cases}
  \to
  \begin{cases}
    Z = 3x_1 + 5x_2                     \\
    x_1 \textcolor{red}{+x_3 =}  4      \\
    2x_2 \textcolor{red}{+x_4 =}  12    \\
    3x_1+2x_2\textcolor{red}{+x_5 =} 18 \\
    x_1 \ge 0,
    x_2 \ge 0,
    \textcolor{red}{x_3 \ge 0, x_4 \ge 0, x_5 \ge 0}
  \end{cases}
$$

Si può notare dal nuovo modello che se una delle variabili di slack(\textit{in rosso}) sono poste a zero allora la soluzione si sul limite di un vincolo. Un valore maggiore di $0$ invece lo porta nella \textit{regione accettabile} e un valore negativo lo porta nella \textit{regione inaccettabile}. Per meglio comprendere viene comodo un esempio, ma prima si deve introdurre un po di terminologia.

\begin{itemize}
  \item \textbf{Soluzione aumentata:} \\
        Soluzione per le variabili originali, \textit{di decisione}, che devono essere aumentate dal valore corrispondente della \textit{variabile di slack}. \\
        \begin{tcolorbox}[
            colback=lightgray,
            colframe=black,
            coltext=black,
            title=Esempio,
            colbacktitle=black,
            coltitle=lightgray,
            breakable
          ]
          Una soluzione normale sarebbe: $(x_1:3,x_2:2) \to (x_1:3,x_2:2, x_3:1, x_4:8, x_5:5) $
        \end{tcolorbox}
  \item \textbf{Soluzione basica:} \\
        È una soluzione CPF aumentata che può trovarsi all'interno o all'esterno della regione accettabile, che porta al condetto di \textit{soluzione basica accettabile} una soluzione basica ha le seguenti proprietà:
        \begin{enumerate}
          \item Ogni variabile può essere o \textit{basica} o \textit{non basica}. \\
                L'insieme dei coefficenti delle variabili basiche si scrive $B_{x_B}$, l'insieme dei coefficenti delle variabili non basiche si scrive $N_{x_N}$. Questo porta il modello a poter essere riscritto così: $B_{x_B}+N_{x_N}=b$
          \item Il numero di \textit{variabili basiche} è uguale al numero di vincoli funzionali, parimenti il numero di \textit{variabili non basiche} sono il grado di libertà.
          \item Le \textit{variabili non basiche} sono settate a $0$.
          \item I valori delle variabili basiche sono ottenute simultaneamente.
          \item Se le \textit{variabili basiche} soddisfano i vincoli di non negatività alla la soluzione basica è accettabile.
        \end{enumerate}
  \item \textbf{Soluzione basica accettabile:}\\
        Come da nome una \textit{soluzione basica} ma con il vincolo di trovarsi nella regione accettabile.
  \item \textbf{Gradi di libertà:} \\
        Differenza tra in numeri di variabili, (\textit{variabili di decisione} + \textit{variabili di slack}) e il numero di \textit{vincoli funzionali}. Indica il numero di variabili che possono essere poste ad un valore aribtrario, $0$, per poter ottenere una soluzione per le variabili rimanenti.
\end{itemize}

\subsection{L'algebra dell'algoritmo del simplesso}
In questo paragrafo verranno rielaborati i punti precedenti per illustrare la connessione tra interpretazione geometrica e algebrica. Ci si riferisce allo stesso problema d'esempio usato precedentemente, in caso di dubbi sui passaggi si faccia riferimento lì.
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Algebra dell'esempio del simplesso,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  \begin{itemize}
    \item \textbf{Inizializzazione}: \\
          Scelgo di mettere $x_1, x_2$ al di fuori della base, in modo da trovare immediatamente i valori di $x_3, x_4, x_5$.
          $$
            \begin{cases}
              Z = 3x_1 + 5x_2           \\
              0+x_3 =  4 \to x_3=4      \\
              0 +x_4 =  12 \to x_4 = 12 \\
              0+0+x_5 = 18 \to x_5 = 18 \\
              x_1 \ge 0,
              x_2 \ge 0,
              x_3 \ge 0,
              x_4 \ge 0,
              x_5 \ge 0
            \end{cases}
          $$
          Si trova quindi la soluzione $(0,0,4,12,18)$.
    \item \circled{1}\textbf{Test di ottimalità} \\
          La funzione obiettivo $Z=3x_1+5x_2=0$. Essendo però i ratei di incremenento positivi i valori possono incrementare. Visto che tutte le altre BF esaminate hanno almeno un parametro maggiore di $0$ allora il valore attuale non è il migliore.
    \item \textbf{Iterazione 1:}
          \begin{enumerate}
            \item \textbf{Determinare la direzione}:
                  L'incrementare di una variabile non basica corrisponde al muoversi in una delle dimensioni. Data la funzione obiettivo $Z=3x_1+5x_2$ so che il coefficente di $x_1$ è $3$ e $x_2$ è $5$, prendo il maggiore: $5$.
            \item \textbf{Dove fermarsi} \\
                  Si vuole incrementare il più possibile il valore di un parametro ma rimanendo nella regione accettabile.
                  $$
                    \begin{cases}
                      Z = 3x_1 + 5x_2                        \\
                      x_1+x_3 =  4 \to x_3=4                 \\
                      2x_2 +x_4 =  12 \to x_4 = 12 - 2x_2    \\
                      3x_1+2x_2+x_5 = 18 \to x_5 = 18 - 2x_2 \\
                      x_1 \ge 0,
                      x_2 \ge 0,
                      x_3 \ge 0,
                      x_4 \ge 0,
                      x_5 \ge 0
                    \end{cases}
                  $$
                  Dal quale si estrapolano i vincoli:
                  $
                    \\
                    x_4=12-2x_2\ge 0 \Rightarrow x_2\le \frac{12}{2}=6 \\
                    x_5=18-2x\ge 0 \Rightarrow x_2 \le \frac{18}{2}=9
                  $
                  Porto $x_4$ a $0$ ottengo $x_2=6$ incrementarlo ulteriormente violerebbe i vincoli. Ci si riferisce a questi calcoli come \textbf{test di rateo minimo}. Quando una variabile viene portata "esce" dalla base e lascia entrare la variabile che viene incrementata.
            \item \textbf{Risolvere per la nuova BF}: \\
                  L'incrementare di $x_2=0\to x_2=6$ sposta il problema ad una nuova BF.
                  \begin{tabular}{ c c c }
                                         & Soluzione BF iniziale & Nuova soluzione BF    \\
                    Variabili non-basice & $x_1=0,x_2=0$         & $x_1,x_4$             \\
                    Variabili basiche    & $x_3=4,x_4=12,x_5=18$ & $x_3=?, x_2=6, x_5=?$
                  \end{tabular}
                  Una volta svolta questa operazione di sostituzione, $x_2$ ha sostituito $x_4$ nella base. Per ottenere lo stesso risultato nella forma algebrica si svolgono semplici operazioni algebriche. \textit{Moltiplicazione} e \textit{divisioni} per un numero diverso da $0$ e \textit{Sommare} o \textit{sottrarre} un'equazione per un altra. Si arriva al risultato desiderato, cioè, il modello trasformato, tramite l'\textit{eliminazione gaussiana} arrivando a:
                  $$
                    \begin{cases}
                      Z-3x_1+\frac{5}{2}x_4=30 \\
                      x_1+x_3=4                \\
                      x_2 + \frac{1}{2}x_4=6   \\
                      3x_1-x_4+x_5=6
                    \end{cases}
                  $$

          \end{enumerate}
    \item \circled{2}\textbf{Test di ottimalità}
          Data la funzione obiettivo $Z=30+3x_1-\frac{5}{2}x_4$ tutti e due i valori non basici posso incrementati ma scelgo $x_1$ visto che ha un coefficente positivo.
    \item \textbf{Iterazione 2:}
          Come nell'iterazione precedente si sceglie una direzione, forzata dalla negatività del coefficente di $x_4$. Dal modello si estrapola:
          $ \\
            x_3=4-x_1 \ge 0 \Rightarrow x_1 \le 4 = 4 \\
            x_2 = 6 \ge 0 \Rightarrow \text{Senza limiti} \\
            x_5= 6-3x_1\ge0\Rightarrow x_1 \le \frac{6}{3} = 2\\
          $
          Nuovamente al terzo step dell'iterazione si usano l'\textit{eliminazione Gaussiana} per scambiare $x_1$ e $x_5$ che restistuisce:
          $$
            \begin{cases}
              Z-\frac{3}{2}x_4+x_5=36             \\
              x_3+\frac{1}{3}x_4-\frac{1}{3}x_5=2 \\
              x_2 + \frac{1}{2}x_4=6              \\
              x_1 -\frac{1}{3}x_4+\frac{1}{3}x_5=2
            \end{cases}
          $$

          La soluzione attuale è quindi $Z=-36-\frac{3}{2}x_4-x_5$, visto che incrementando un qualsiasi valore della funzione obiettivo peggioreremmo il valore di $Z$ possiamo dire con cercettezza che abbiamo trovato una soluzione ottima.
  \end{itemize}
\end{tcolorbox}

\subsection{Soluzione tabulare}
Nonostante ne si sia discusso estensivamente c'è un altro modo per visualizzare la risoluzione del modello. La soluzione \textit{geometrica} serve ad avere una rapida visualizzazione del problema, mentre la versione aritmetica è la più adatta per una risoluzione tramite un programma. C'è una via di mezzo che concilia la semplicità di comprensione tra uomo e computer, la versione \textbf{tabulare}. In questo contesto la tabella che useremo si chiama \textit{tablue}.
$
  \\ \\ \\
  \begin{cases}
    Z-3x_1-5x_2 = 0        \\
    x_1 + x_3 = 4          \\
    2x_2 + x_4 = 12        \\
    3x_1 + 2x_2 + x_5 = 18 \\
  \end{cases}
  \Rightarrow
$
\begin{tabular}{|c|c|c|c|c|c|c|c|}
  \hline
  {\textbf{Variabili basiche}} & \multicolumn{6}{|c|}{\textbf{Coefficenti}} & \textbf{Vincoli}                                                                          \\
  \cline{1-7}
                               & $\mathbf{Z}$                               & $\mathbf{x_1}$   & $\mathbf{x_2}$ & $\mathbf{x_3}$ & $\mathbf{x_4}$ & $\mathbf{x_5}$ &    \\
  \hline
  $Z$                          & 1                                          & -3               & -5             & 0              & 0              & 0              & 0  \\
  $x_3$                        & 0                                          & 1                & 0              & 1              & 0              & 0              & 4  \\
  $x_4$                        & 0                                          & 0                & 2              & 0              & 1              & 0              & 12 \\
  $x_5$                        & 0                                          & 3                & 2              & 0              & 0              & 1              & 18 \\
  \hline
\end{tabular} \\ \\

\subsubsection{Riassunto del metodo del simplesso}
\textbf{Inizializzazione:} \\
Si introducono le variabili di slack e si decide che le variabili di decisione siano al di fuori della base(rosso) e complementarmente le variabili di slack siano nella base(blue). \\
\textbf{Test di ottimalità:} \\
La soluzione BF è ottima se e solo se ogni coefficente nella funzione obiettivo è non negativa, ergo il test di ottimalità non è passato.\\
\begin{table}[h]
  \centering
  \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
    \hline
    {\textbf{Variabili basiche}} & \multicolumn{6}{|c|}{\textbf{Coefficenti}} & \textbf{Vincoli}    & \textbf{Rateo}                                                                                                     \\
    \cline{1-9}
                                 & $\mathbf{Z}$                               & $\mathbf{x_1}$      & $\mathbf{x_2}$           & $\mathbf{x_3}$      & $\mathbf{x_4}$      & $\mathbf{x_5}$      &    &                  \\
    \hline
    $Z$                          & 1                                          & -3                  & -5                       & 0                   & 0                   & 0                   & 0  &                  \\
    $x_3$                        & 0                                          & 1                   & \textcolor{darkgreen}{0} & 1                   & 0                   & 0                   & 4  &                  \\
    $x_4$                        & 0                                          & \textcolor{blue}{0} & \textcolor{red}{2}       & \textcolor{blue}{0} & \textcolor{blue}{1} & \textcolor{blue}{0} & 12 & $\frac{12}{2}=6$ \\
    $x_5$                        & 0                                          & 3                   & \textcolor{darkgreen}{2} & 0                   & 0                   & 1                   & 18 & $\frac{18}{2}=9$ \\
    \hline
  \end{tabular}
\end{table}

I passaggi da svolgere sono i segunti e generano il tablue successivo:
\begin{enumerate}
  \item Dividere la \textit{riga pivot} per il valore del \textit{numero di pivot}.
  \item Sommare la nuova riga di pivot per il coeffincente di pivot, ($|\text{n pivot}|\cdot \text{riga}$), ad ogni altra riga che abbia nella colonna di pivot un valore negativo.
  \item Per ogni riga che nella colonna di pivot ha un valore positivo, sottrarre la nuova riga di pivot per il coeffincente di pivot, ($|\text{n pivot}|\cdot \text{riga}$).
\end{enumerate}
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Attenzione,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Si può notare, che le variabile basiche nel \textit{tablue} hanno la forma della matrice $I$ di identità. Infatti dopo la prima iterazione dove $x_2$ prende il posto di $x_4$ i vettori che formano la base della matrice sono le nuove variabili di base: ($x_2, x_3, x_5$)
\end{tcolorbox}

\begin{table}[h]
  \centering
  \begin{tabular}{|c|c|c|c|c|c|c|c|}
    \hline
    {\textbf{Variabili basiche}} & \multicolumn{6}{|c|}{\textbf{Coefficenti}} & \textbf{Vincoli}                                                                          \\
    \cline{1-8}
                                 & $\mathbf{Z}$                               & $\mathbf{x_1}$   & $\mathbf{x_2}$ & $\mathbf{x_3}$ & $\mathbf{x_4}$ & $\mathbf{x_5}$ &    \\
    \hline
    $Z$                          & 1                                          & -3               & 0              & 0              & $\frac{5}{2}$  & 0              & 30 \\
    $x_3$                        & 0                                          & 1                & 0              & 1              & 0              & 0              & 4  \\
    $x_2$                        & 0                                          & 0                & 1              & 0              & $\frac{1}{2}$  & 0              & 6  \\
    $x_5$                        & 0                                          & 3                & 0              & 0              & -1             & 1              & 6  \\
    \hline
  \end{tabular}
\end{table}

Da qui, si continua con il normale svoglimento dell'algoritmo del simplesso, nello stesso modo evidenziato precendentemente, quindi si eviteranno commenti che ormai potrebbero essere ridondanti. Nell'ultimo tablue, visto che $x_1, x_2$ sono nella base si è arrivati alla soluzione ottima che il valore del vincolo, in verde.

\begin{table}[h]
  \centering
  \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
    \hline
    {\textbf{Numero iterazione}} & {\textbf{Variabili basiche}} & \multicolumn{6}{|c|}{\textbf{Coefficenti}} & \textbf{Vincoli}                                                                                                                                 \\
    \cline{1-8}
                                 &                              & $\mathbf{Z}$                               & $\mathbf{x_1}$           & $\mathbf{x_2}$           & $\mathbf{x_3}$      & $\mathbf{x_4}$      & $\mathbf{x_5}$      &                          \\
    \hline
    0                            & $Z$                          & 1                                          & -3                       & \textcolor{darkgreen}{5} & 0                   & 0                   & 0                   & 0                        \\
                                 & $x_3$                        & 0                                          & 1                        & \textcolor{darkgreen}{0} & 1                   & 0                   & 0                   & 4                        \\
                                 & $x_4$                        & 0                                          & \textcolor{blue}{0}      & \textcolor{red}{2}       & \textcolor{blue}{0} & \textcolor{blue}{1} & \textcolor{blue}{0} & \textcolor{blue}{12}     \\
                                 & $x_5$                        & 0                                          & 3                        & \textcolor{darkgreen}{2} & 0                   & 0                   & 1                   & 18                       \\
    \hline
    1                            & $Z$                          & 1                                          & -3                       & 0                        & 0                   & $\frac{5}{2}$       & 0                   & 30                       \\
                                 & $x_3$                        & 0                                          & \textcolor{darkgreen}{1} & 0                        & 1                   & 0                   & 0                   & 4                        \\
                                 & $x_2$                        & 0                                          & \textcolor{darkgreen}{0} & 1                        & 0                   & $\frac{1}{2}$       & 0                   & 6                        \\
                                 & $x_5$                        & 0                                          & \textcolor{red}{3}       & \textcolor{blue}{0}      & \textcolor{blue}{0} & \textcolor{blue}{0} & \textcolor{blue}{1} & \textcolor{blue}{6}      \\
    \hline
    2                            & $Z$                          & 1                                          & 0                        & 0                        & 0                   & $\frac{3}{2}$       & 1                   & 36                       \\
                                 & $x_3$                        & 0                                          & 0                        & 0                        & 1                   & $\frac{1}{3}$       & -$\frac{1}{3}$      & 2                        \\
                                 & $x_2$                        & 0                                          & 0                        & 1                        & 0                   & $\frac{1}{2}$       & 0                   & \textcolor{darkgreen}{6} \\
                                 & $x_1$                        & 0                                          & 1                        & 0                        & 0                   & -$\frac{1}{3}$      & $\frac{1}{3}$       & \textcolor{darkgreen}{2} \\
    \hline
  \end{tabular}
\end{table}

\subsection{Forma canonica}
Dato un modello in forma standard, nella forma di una funzione obiettivo ($Z=C_B^Tx_B+C^T_Nx_N$) e un matrice che rappresenta le funzioni di vincolo($B_{X_B}+N_{X_N}=b$) si può riscrive il modello in modo di poter trovare $x_B$.

$$
  \begin{cases}
    Z=C_B^Tx_B+C^T_Nx_N \\
    B_{X_B}+N_{X_N}=b   \\
    X_B, X_N \ge 0
  \end{cases}
  \overset{\text{Moltiplico per } B^{-1}}{\Longrightarrow}
  \begin{cases}
    Z=C_B^Tx_B+C^T_Nx_N       \\
    Ix_B+(B^{-1}N)x_N=B^{-1}b \\
    X_B, X_N \ge 0
  \end{cases}
  \to x_B= (B^{-1}N)x_n=B^{-1}b
$$
Si è ora trovata la funzione per trovare il valore di $x_B$. Ora l'idea è vedere cosa succede se insieriamo nella funzione obiettivo il valore dei coefficenti della base.
$$
  \begin{cases}
    Z=C_B^Tx_B+C^T_Nx_N       \\
    Ix_B+(B^{-1}N)x_N=B^{-1}b \\
    X_B, X_N \ge 0
  \end{cases}
  \overset{\text{Inserisco }x_B}{\Longrightarrow}
  \begin{cases}
    Z=C_B^TB^{-1}b+(C^T_N-C^T_BB^{-1}N)x_N \\
    Ix_B+(B^{-1}N)x_N=B^{-1}b              \\
    X_B, X_N \ge 0
  \end{cases} \\
  {\Rightarrow}
  \begin{cases}
    Z=Z_B+\overline{C}^T_Nx_N         \\
    Ix_B+\overline{N}x_N=\overline{b} \\
    X_B, X_N \ge 0
  \end{cases}
$$

\section{Teoria della dualità}
Uno dei concetti più importanti nella programmazione lineare è il concetto di \textbf{dualità}. Ogni problema di programmazione lineare ha associato un altro problema chiamato \textbf{dualità}. La relazione tra due problemi duali, dove quello originale si chiama \textbf{primale} è molto utile in vari ambiti. Uno degli usi fondamentali è l'implentazioine della \textit{analisi della sensitività}. Questa connessione deriva dal fatto che i valori del modelli primale sono stime di condizioni future, l'effetto sulle soluzioni prevale quando in realtà andrebbe ultreriormente investigato.

\subsection{Essenza della teoria della dualità:}
Dato un problema primale il problema duale si trova invertendo: funzione obiettivo e vincoli funzionali. (Nota bene: $n$ è il numero di parametri e $m$ è il numero di vincoli)
$$
  \overset{\text{Prob. primale}}{
    \begin{cases}
      \text{Max}(Z=\sum_{j=1}^{n}c_jx_j)        \\
      \sum_{j=1}^{n}a_{ij}x_j\le b_b|i\in [1,m] \\
      x_j\ge 0|j\in [1,n]
    \end{cases}
  }
  \hspace{3cm}
  \overset{\text{Prob. Duale}}{
    \begin{cases}
      \text{Min}(Z=\sum_{j=1}^{m}b_iy_i)        \\
      \sum_{i=1}^{m}a_{ij}y_i\ge c_j|j\in [1,n] \\
      y_i\ge 0|j\in [1,n]
    \end{cases}
  }
$$

Si noti che dove il problema priamrio è in forma di massimizzazione allora il problema duale è in forma di minimizzazione. Il problema duale usa anche gli stessi parametri. Le differenze sono le seguenti.
\begin{itemize}
  \item I coefficenti della funzione obiettivo del problema primale si trovato come parametri nelle funzioni di vincolo del problema duale.
  \item I parametri del problema primale sono i coefficenti delle funzioni obiettivo del problema duale.
  \item I coefficenti di una variabile nelle funzioni di vincolo di un problema primale sono i coefficenti della funzione vincolo del problema duale.
\end{itemize}

Queste differenze si notato al meglio in notazione matriciale.
$$
  \overset{\text{Prob. primale}}{
    \begin{cases}
      \text{Max}(Z=\textcolor{red}{c}x)                 \\
      \textcolor{blue}{A}x \le \textcolor{darkgreen}{b} \\
      x \ge 0
    \end{cases}
  }
  \hspace{3cm}
  \overset{\text{Prob. Duale}}{
    \begin{cases}
      \text{Min}(W=y\textcolor{darkgreen}{b})         \\
      \textcolor{blue}{A^{T}}y \ge \textcolor{red}{c} \\
      y \ge 0
    \end{cases}
  }
$$

\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Esempio,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Creiamo il problema duale dell'esercizio della Schiopparelli \& co. Dato il solito modello. Troviamo prima di tutto $\overline{x}, \overline{c}, \overline{b}, A$.\\
  \begin{equation*}
    \begin{cases}
      \text{Max}\ Z = 3x_1 + 5x_2 \\
      x_1 \le 4                   \\
      2x_2 \le 12                 \\
      3x_1 + 2x_2 \le 18          \\
      x_1, x_2, x_3 \ge 0
    \end{cases}
  \end{equation*}
  \begin{equation*}
    \begin{array}{cccc}
      \overline{x} = \begin{bmatrix} x_1 & x_2 \end{bmatrix},  &
      \overline{c} = \begin{bmatrix} 3 & 5 \end{bmatrix},      &
      \overline{b} = \begin{bmatrix} 4 & 12 & 18 \end{bmatrix} &
      A = \begin{bmatrix} 1 & 0\\ 0 & 2 \\ 3 & 2\end{bmatrix}
    \end{array}
  \end{equation*}
  $
    \begin{cases}
      \text{Min}(W=y\textcolor{darkgreen}{b})         \\
      \textcolor{blue}{A^{T}}y \ge \textcolor{red}{c} \\
      y \ge 0
    \end{cases}
    \to
    \begin{cases}
      \text{Min}(W=4y_1+12y_2+18y_3) \\
      y_1+3y_3 \ge 3                 \\
      2y_2+2y_3 \ge 5                \\
      y \ge 0
    \end{cases}
  $

\end{tcolorbox}

Si può ora notare la relazione tra il problema primale e il problema duale.
\begin{itemize}
  \item I parametri per un vincolo in uno dei due problemi sono i coefficenti di una variabile nell'altro problema
  \item I coefficenti della funzione obiettivo di uno dei due problemi sono i parametri delle funzioni di vincolo dell'altro problema.
  \item Si può anche notare che su un problema ha $n$ parametri nella funzione obiettivo e $m$ vincoli allora il problema duale avrà $m$ parametri nella funzione obiettivo e $n$ vincoli allora il problema duale
\end{itemize}

\subsubsection{Relazione dei problemi primali-duali}

  

\textbf{Proprietà di dualità debole}\\
Se $\overline{x}$ è accetabile per la soluzione per problema primale e $\overline{y}$ è accettabile per la soluzione di del problema duale allora $\overline{c}\overline{x}\le \overline{y}\overline{b}$. Quest'affermazione deve valore per ogni coppia di soluzione accetabili, il valore massimo di $Z=cx$ è uguale al valore minimo possibile per $W=yb$.\\
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Dimostrazione,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  \textbf{Dimostrazione:}\\
  Data una coppia  di problema composti da uno \textit{primale} e uno \textit{duale} così formulati:\\
  \hspace{3cm}P: Max $Z=c^Tx, Ax \le b, x (\in X) \ge 0$\\
  \hspace{3cm}D: Min $W=b^Ty, A^Ty\ge c, y(\in X) \ge 0$\\
  $$
    \begin{cases}
      A^T_{n \ m}\overline{y}_m \ge \overline{c}_n \\
      \overline{x}_n \ge 0                         \\
    \end{cases}
    {\Rightarrow} \underset{\overline{x}_{n\ 1}\cdot A_{n\ m} = \alpha_{1\ m} \\ \alpha_{1 m}\cdot \overline{y}_{1\ m} = k}{\overline{x}_n^TA^T_{n\ m}\overline{y}^T_m} \ge \underset{\text{Scalare}}{\overline{x}_n^T\overline{c}_n} \Leftrightarrow \underbrace{\overline{c}_n^T\overline{x}_n}_{Z} \le \overline{x}_n^TA_{n\ m}^T\overline{y_m}^T
  $$
  $$
    \begin{cases}
      A\overline{x} \le \overline{b} \\
      \overline{y}\ge 0              \\
    \end{cases}
    {\Rightarrow} \overline{y}_m^TA_{m\ n}\overline{x}_n \ge \overline{y}_m^Tb_m \Leftrightarrow \underbrace{\overline{b}_m^T\overline{y}_m}_{W} \ge \overline{y}_m^TA_{m\ n}\overline{x}_n
  $$
  In entrambi casi il secondo membro è uno scalare che porta a poter scrivere $\overline{x}^TA^T\overline{y}=(\overline{x}^TA^T\overline{y})^T$ visto che il trasposto di uno scalare è sé stesso. Ma per la proprietà $(BA)^T=B^TA^T$ posso scrivere $(\overline{x}^TA^T\overline{y})^T=\overline{y}^T (A^T)^T (\overline{x}^T)^T$. Tolgo le trasposte ridontanti e ottengo $(\overline{x}^TA^T\overline{y})^T=\overline{y}^TA\overline{x}$ arrivando allora a poter riassumere tutto così:
  $$\overline{x}^T A^T \overline{y} = (\overline{x}^T A^T \overline{y})^T = \overline{y}^T (A^T)^T (\overline{x}^T)^T = \overline{y}^T A \overline{x}$$

  Assemblando il tutto:
  $$\underset{Z(\overline{x})}{c^T \overline{x}} \leq \overline{x}^T A^T \overline{y} = \overline{y}^T A \overline{x} \leq \underset{W(\overline{y})}{b^T \overline{y}}$$
\end{tcolorbox}
A questo teorema seguono due corollari:
\begin{itemize}
  \item Se $\overline{x} \in X, \overline{y} \in Y, z(\overline{x})=w(\overline{y})$ allora $\overline{x}=x^{\ast}, \overline{y}=y^{\ast}, z(\overline{x})=z^{\ast}, w(\overline{y})=w^{\ast}$
  \item Se il problema prilame è \textit{illimitato} allora il suo duale è \textit{inammissibile}.
\end{itemize}
\textbf{Lemma di Farkas:}\\
Il lemma di Farkas dice che dato $A_{m\ n}\overline{x}_m=\overline{b}_m$ allora una sola delle seguenti è vera:
\begin{enumerate}
  \item $\exists\overline{x} \in R^n|A\overline{x}=\overline{b}, \overline{x}\ge 0$
  \item $\exists\overline{y} \in R^m|A^T\overline{y}\ge 0, \overline{b}^T\overline{y} < 0$
\end{enumerate}
Questo significa che dato un sistema di equazioni o esiste una soluzione o non esiste.
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Dimostrazione,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  \begin{enumerate}
    \item $1)$ è vera, $2)$ è falsa.\\
          Riscrivo le premesse:\\

          $
            \begin{cases}
              A\overline{x}=\overline{b}                             \\
              \exists \overline{x}\in R^n|A\overline{x}=\overline{b} \\
              \overline{x}\ge \overline{0}                           \\
            \end{cases}
          $
          Date le premesse:
          \begin{itemize}
            \item $A^T\overline{y}\ge 0 \Rightarrow \underset{\text{scalare}}{\overline{x}^T A^T y > 0} \forall\overline{y}\in R^m$
            \item $\overline{x}^TA^T=\overline{b}^T \Rightarrow \overline{b}^T\overline{y}\ge 0 \forall \overline{y} \in R^m$
            \item $\nexists\overline{y}\in R^m| A^T\overline{y}\ge 0, b^T\overline{y} < 0$ perché nel punto precedente abbiamo dimostrato che $\overline{b}^T\overline{y}\ge 0 \forall \overline{y} \in R^m$.
          \end{itemize}
    \item $1)$ è false, $2)$ è vera.\\
          \begin{tcolorbox}[
              colback=lightgray,
              colframe=black,
              coltext=black,
              title=Convessità,
              colbacktitle=black,
              coltitle=lightgray,
            ]
            Uno spazio vettoriale $C$ è convesso se per ogni coppia di punti $x,y$:\\
            $\forall x, y \in C, \forall \lambda \in [0,1] \to \lambda x+(1-\lambda)y \in C$. In poche parole l'insieme è convesso se per ogni coppia di punti contiene tutti i segmenti li uniscono.
          \end{tcolorbox}
          \begin{tcolorbox}[
              colback=lightgray,
              colframe=black,
              coltext=black,
              title=Teorema dell'iperpiano separatore,
              colbacktitle=black,
              coltitle=lightgray,
              breakable
            ]
            Siamo $A$ e $B$ due insiemi convessi in una spazio vettoriali $R^n$ Allora $\exists H, \exists a : a\cdot x \le c \forall x \in A, a \cdot y \ge c \forall y \in B$
          \end{tcolorbox}
          Assumiamo che $1)$ sia falsa e definiamo il cono $C={\overline{q}\in R^m|\exists X(\overline{q}\in R^n|Ax(q)=q, x(q) \ge 0)}$.\\ $C$ è convesso, essendo $1)$ falsa $b\notin C$. \\
          Per il teorema del iperpiano separatore: \\
          \begin{itemize}
            \item $\exists \overline{y}\in R^m-{0}:\overline{q}^T\overline{y} \ge 0\ \forall \overline{q} \in C, \overline{b}^T\overline{y} <0$.
            \item Dato: $q=Ax(\overline{q})\ \forall q \in C$ si ha: $\overline{q}^T\overline{y}\ge 0\ \forall q \in C \Rightarrow x(q)^TA^T\overline{y} \ge 0 \forall q \in C$
            \item $x(q)\ge 0 \forall q \in C \to x(q)^TAT\overline{y}\ge 0\ \forall q \in C \Rightarrow A^T\overline{y} \ge 0$
            \item Abbiamo dimostrato che $A^T\overline{y}\ge 0$.
          \end{itemize}
          \textit{Dimostrazione inutilmente complicata}
  \end{enumerate}
\end{tcolorbox}
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Versione alternativa di Farkas,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Dato un sistema di equazioni lineari $A_{m\ n}x\le b_m, x \ge 0$, allora una sola è vera\\
  \begin{itemize}
    \item $\exists \overline{x} \in R^n: A\overline{x}\ge b, \overline{x}\ge 0$
    \item $\exists \overline{y} \in R^m: A^T_{n\ m}\overline{y}\ge 0, b^T\overline{y} < 0, \overline{y} \ge 0$
  \end{itemize}

  Introduciamo un vettore $\overline{s} \ge 0$. La prima condizione del \textbf{Lemma} diventa: $$ \exists \overline{x} \in R^n, \overline{s} \in R^m: A\overline{x}+Is=b, \overline{x} \ge 0, \overline{s} \ge 0$$
  Definiamo $A'=[A|I]_{m, (n+m)}$ e $x'=\begin{bmatrix}\overline{x} \\ \overline{s}\end{bmatrix}_{1, (n+m)}$\\
  Le due condizioni diventano: \\
  $\exists x' \in R^{n+m} : A'x' = b, x' \ge 0$ che diventa per il lemma di Farkas alternativa a:\\ $\exists y \in R^m : A'^T y \ge 0, b^T y < 0, y \ge 0.$
\end{tcolorbox}
\textbf{Proprietà di dualità forte}\\
Se ${x}^{\ast}$ è una soluzione ottima per il problema ottimale e ${  y}^{\ast}$ allora $cx^{\ast}=y^{\ast}b$. Questo si può dedurre dal punto precendente. Perché tra tutte le soluzioni per il problema primale $x^{\ast}$ è il massimo dell'insieme delle soluzioni accettabili, per $y^{\ast}$ è il minore delle soluzioni accettabili per il problema duale. Avendo il vincolo della \textbf{proprietà  di dualità debole} $cx\le yb$ l'unico caso in cui le due soluzioni possano essere uguali è avere la soluzione ottima.
\begin{tcolorbox}[
    colback=lightgray,
    colframe=black,
    coltext=black,
    title=Dimostrazione,
    colbacktitle=black,
    coltitle=lightgray,
    breakable
  ]
  Sia $y^{\ast} \in R^m$ una soluzione ottima per il problema \textbf{duale} di valore: $w^{\ast}=b^Ty^{\ast}$, il valore è uno scalare. \\
  Lo scopo della dimostrazione è arrivare a dimostrare $\exists\overline{x}^{\ast}\in R^n: A\overline{x}^{\ast}\le\overline{b}, \overline{x}^{\ast}$ che soddisfa $c^T\overline{x}^{\ast}\ge b^T\overline{y}^{\ast}$ (che sono scalari).\\
  \textbf{Prima parte}
  \begin{itemize}
    \item Assumiamo che $\nexists \in R^n: Ax \le b, x \ge 0, c^T\overline{x} \ge \overline{w}^{\ast}$
    \item Allora posso scrivere $\nexists \in R^n: Ax \le b, -c^Tx\le -w^{\ast}, x\ge 0$
    \item $A'=\begin{bmatrix}A \\ -c^T\end{bmatrix}_{(m+1)\ \text{x}\ n} b'=\begin{bmatrix}b \\ -w^{\ast}\end{bmatrix}_{(m+1)\ \text{x}\ 1}$
    \item Equivale $\nexists x \in R^n: A'x \le b', x \ge 0$ che implica $\exists y' \in R^{m+1}:A'^Ty' \ge 0, b'^Ty' < 0, y' \ge 0$.
  \end{itemize}
  \textbf{Seconda parte}
  \begin{itemize}
    \item $\exists y' \in R^{m+1}:A'^Ty' \ge 0, b'^Ty' < 0, y' \ge 0$ sia $y'=\begin{bmatrix}\overline{y}\in R^m\\ \lambda \in R \end{bmatrix}$
    \item Allora $A'^T\overline{y}' \ge 0, b'^T\overline{y}' < 0, \overline{y}'\ge 0 \Leftrightarrow A^T\overline{y}-c\delta\ge 0, b^T\overline{y}-w^{\ast}\delta<0, \overline{y}\ge 0, \delta \ge 0$
  \end{itemize}
  $A^T\overline{y}-c\lambda \ge 0, b^T\overline{y}-w^{\ast}\lambda<0,\overline{y}\ge 0, \lambda \ge 0$.\\
  \textbf{Caso I:($\lambda > 0$)}\\
  $\hat{y}=\frac{\overline{y}}{\lambda}$ si ha $\begin{cases}A^T\hat{y}\ge c \\ b^T \hat{y} < w^{\ast} \\ \hat{y} \ge 0 \end{cases}$\\

  \textbf{Caso II:($\lambda = 0$)}\\
  $A^T\overline{y}-c\lambda \ge 0, b^T\overline{y}-w^{\ast}\delta<0, \overline{y} \ge 0 \rightarrow A^T\overline{y} \ge 0 b^T\overline{y}<0, \overline{y} \ge 0$\\
  Se $\hat{y}=y^{\ast}+\overline{y}$. Da cui ottiene $A^T\overline{y}^{\ast} \ge c, b^T\overline{y}^{\ast}=w^{\ast}, y^{\ast}\ge 0$\\
  Da questo si ottiene $A^T\hat{y}\ge c, b^T\hat{y} < w^{\ast}, \hat{y}\ge 0$

  Quindi possiamo dimostrare per assurdo: $\exists x^{\ast} \in R^n: Ax^{\ast} \le b, x^{\ast} \ge 0, c^Tx^{\ast}\ge w^{\ast} \to z^{\ast}=c^Tx^{\ast}=b^Ty^{\ast}=w^{\ast}$
\end{tcolorbox}

\textbf{Proprietà della soluzione complementare}\\
Ad ogni iterazione dell'algoritmo del simplesso l'algoritmo identifica simultaneamente i CPF in $x$ per il problema primale e la soluzione complementare di $y$ per il problema duale tale che $cx=yb$. Da questo si può dedurre che se $x$ non è ottima allora neanche $y$ sarà ottima.

\textbf{Proprietà della soluzione ottima complementare}\\
All'iterazione finale, l'algoritmo del simplesso identifica simultaneamente la soluzione ottima per il problema primale($x^{\ast})$ e per il problema duale($y^{\ast}$) tale che $cx^{\ast}=y^{\ast}b$.\\

\textbf{Teorema Fondamentale Dualità Lineare}\\
Data una coppia di problemi.\\
$$ P: \text{Max}\ z(x)\ x \in X$$
$$D: \text{Min}\ w(x)\ y \in Y$$
Allora una delle quattro è vera.
\begin{itemize}
  \item Esiste la soluzione ottima per $P$ e $D$
  \item Esiste la soluzione ottime per $P$ e $D$ è inammissibile
  \item Esiste la soluzione ottime per $D$ e $P$ è inammissibile
  \item $P$,$D$ sono inammissibili.
\end{itemize}

\textbf{Teorema dello scarto complementare}\\
Dato una coppia primale-duale\\
$$P: \text{Max}\ z=c^Tx, Ax \ge b, x \ge 0$$
$$D: \text{Min}\ w=b^Ty, A^Ty \ge c, y \ge 0$$

La condizione per l'ottimalità è:
$$\overline{y}^T(b-A\overline{x})=0$$
$$(A^T\overline{y}-\overline{c})^T\overline{x}=0$$



\textbf{Teorema dello scarto complementare}\\
Data la coppia:
$$P: max(z)=c^Tx: Ax \le b, x \ge 0$$
$$D: mix(w)=b^Ty: A^Ty \ge c, y \ge 0$$

Allora date le soluzioni ottime $\overline{x}^{\ast}$ $\overline{y}^{\ast}$ sono valide le seguenti equazioni:

$$\overline{y}^T(b-A\overline{x})=0$$
$$(A^T\overline{y}-c)^T\overline{x}=0$$

\begin{tcolorbox}[
  colback=lightgray,
  colframe=black,
  coltext=black,
  title=Dimostrazione,
  colbacktitle=black,
  coltitle=lightgray,
  breakable
  ]
  Sappiamo che dati due problemi duali $P$ e $D$ che hanno entrambi soluzioni ottime vale l'equazione: $z^{\ast}=c^T\overline{x}^{\ast}=\overline{b}^Ty^{\ast}=\overline{w}^{\ast}$\\
  Sappiamo anche che nella soluzione: $A\overline{x}=b$ e $A^T\overline{y}=c$, da questi si può ricavare:\\
  $A\overline{x}-b=0\to b-A\overline{x}$=0 \& $A^T\overline{y}-c=0$\\
  Sostituiamo nelle premesse e ci viene: $\overline{y}^T(0)=0$ e $(0)^T\overline{x}=0$. Quindi il teorema è dimostrato.
\end{tcolorbox}

\subsection{Algoritmo simplesso duale}

Dato i coefficenti di $P$ e $D$ sono gli stessi cioé $A$ e $A^T$ quindi si possono rappresentare con lo stesso tablueat.\\
\textbf{Problema Primale:} Conserva l'ottimalità e persegue l'ottimalità.\\
\textbf{Problema Duale:} Conserva l'ottimalità e persegue l'ammissibilità.

\begin{itemize}
  \item La riga di pivot viene nella prima colonna
  \item Il pivot deve essere non negativa
  \item La colonna di Pivot viene scelta minimizzando il valore assoluto del rapporto tra il coefficente di costo ridotto ed il candidato pivot.
\end{itemize}
\textbf{DA QUI LA QUALITA' CALA}

\section{\textbf{Sezione post-ottima:}}

Controllo della robustezza del progetto. Esso viene fatto tramite l'analisi post'ottima.\\
Input: $A, \overline{b}, \overline{c}$\\
Output: $B^{\ast}, \overline{x}^{\ast}, \overline{z}^{\ast}$.\\
L'Analisi post-ottima ha lo scopo di capir quanto può variare ogni coefficente(dei vettori $\overline{c}$ e $\overline{b}$) $c_j, b_i$ senza che cambi la base ottima $B^{\ast}$.\\
La Base $B^{\ast}$ rimane ottima finché:
\begin{itemize}
  \item Ammissibilità: $x_B=B^{-1}b \ge 0$
  \item Ottimalità: $c_N=c_N-c_BB^{-1}N \ge 0$
\end{itemize}

Come effettuare l'analisi post'ottima va eseguita nella forma:
\begin{itemize}
  \item Funzione obiettivo massimizzato.
  \item Vincoli in forma di disuguaglianza $\ge$
\end{itemize}
Consideriamo una colonna $\overline{j}$ con due casi:
\begin{enumerate}
  \item ($\overline{j} \in B$ e $\overline{r}$):\\ $\text{max}\{-\infty, \underset{j \in N^+}{\text{max}}\{\frac{-c_j^{\ast}}{a^{\ast+}_{\overline{r}j}}\}\} \le \Delta c_{\overline{j}} \le \text{min}\{\underset{j \in N^-}{\text{min}}\{\frac{-c^{\ast}_j}{a^{\ast -}_{\overline{r}j}}\}, +\infty\}$
  \item ($\overline{j} \in N$): $\Delta c_{\overline{j}} \le c_{\overline{j}^{\ast}}$
\end{enumerate}

\end{document}